@model VerdeoVentas.Models.Venta
@using VerdeoVentas.Enums

<h2>Crear una venta</h2>

<form asp-action="Create" method="post" oninput="calculateTotal()">
    <div>
        <label for="Cliente">Cliente</label>
        <input type="text" id="Cliente" name="Cliente" required />
    </div>
    <div>
        <label for="Pedido">Pedido</label>
        <input type="text" id="Pedido" name="Pedido" />
    </div>
    <div>
        <label for="Precio">Precio</label>
        <input type="number" id="Precio" name="Precio" step="0.01" required />
    </div>
    <div>
        <label for="Pago">Pago</label>
        <input type="checkbox" id="Pago" name="Pago" value="true" onchange="updateCheckboxLabel('Pago')" />
        <span id="PagoLabel">No</span>
    </div>
    <div>
        <label for="TipoDePago">Tipo de pago</label>
        <select id="TipoDePago" name="TipoDePago">
            @foreach (var tipo in Enum.GetValues(typeof(TipoDePago)))
            {
                <option value="@tipo">@tipo</option>
            }
        </select>
    </div>
    <div>
        <label for="FechaVenta">Fecha de venta</label>
        <input type="date" id="FechaVenta" name="FechaVenta" value="@DateTime.Now.ToString("yyyy-MM-dd")" />
    </div>
    <div>
        <label for="Envio">Envio</label>
        <input type="checkbox" id="Envio" name="Envio" value="true" onchange="updateCheckboxLabel('Envio')" />
        <span id="EnvioLabel">No</span>
    </div>
    <div>
        <label for="Total">Total</label>
        <input type="number" id="Total" name="Total" step="0.01" readonly />
    </div>
    <button type="submit">Agregar venta</button>
</form>

<script>
    function calculateTotal() {
        var precio = parseFloat(document.getElementById('Precio').value) || 0;
        var envio = document.getElementById('Envio').checked ? 500 : 0;
        var total = precio + envio;
        document.getElementById('Total').value = total.toFixed(2);
    }

    function updateCheckboxLabel(id) {
        var checkbox = document.getElementById(id);
        var label = document.getElementById(id + 'Label');
        label.textContent = checkbox.checked ? 'Sí' : 'No';
    }

    document.getElementById('Precio').addEventListener('input', calculateTotal);
    document.getElementById('Envio').addEventListener('change', calculateTotal);
</script>